<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SpaTopic">
<title>SpaTopic Basics â€¢ SpaTopic</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SpaTopic Basics">
<meta property="og:description" content="SpaTopic">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SpaTopic</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/SpaTopic.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Model_Selection.html">Model Selection</a>
    <a class="dropdown-item" href="../articles/Intro_SpaTopic.html">SpaTopic Basics</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>SpaTopic Basics</h1>
                        <h4 data-toc-skip class="author">Xiyu Peng</h4>
            
            <h4 data-toc-skip class="date">2023-12-20</h4>
      
      
      <div class="d-none name"><code>Intro_SpaTopic.Rmd</code></div>
    </div>

    
    
<p>**More detailed documentation is available at the <a href="https://xiyupeng.github.io/SpaTopic/" class="external-link">SpaTopic Home Page</a>. Please check the <a href="https://github.com/xiyupeng/SpaTopic" class="external-link">github page</a> for more detailed information for the package.</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Recent advancements in multiplexed tissue imaging allow for examination of tissue microenvironments in great detail. These cutting-edge technologies offer invaluable insights into cellular heterogeneity and spatial architectures, playing a crucial role in decoding mechanisms of treatment response and disease progression.</p>
<p>However, gaining a deep understanding of complex spatial patterns remains challenging. <code>SpaTopic</code> implements a novel spatial topic model to integrate both cell type and spatial information to identify the complex spatial tissue structures without human intervention. The Collapsed Gibbs sampling algorithm is used for model inference. Contrasting to computationally intensive K-nearest-neighbor-based cell neighborhood analysis approaches, <code>SpaTopic</code> is more scalable to large-scale image datasets without extracting neighborhood information for every single cell.</p>
<p><code>SpaTopic</code> can be applied either on a single image or across multiple images.</p>
</div>
<div class="section level2">
<h2 id="simple-usage">Simple Usage<a class="anchor" aria-label="anchor" href="#simple-usage"></a>
</h2>
<p>The required input of SpaTopic is a data frame containing cells within on a single image or a list of data frames for multiple images. Each data frame consists of four columns:</p>
<ul>
<li>image: Image ID</li>
<li>X, Y: X, Y cell coordinate</li>
<li>type: cell type information</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SpaTopic</span><span class="op">)</span></span>
<span><span class="co">## The input can be a data frame or a list of data frames</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"lung5"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">lung5</span><span class="op">)</span></span>
<span><span class="co">#&gt;      image        X        Y           type</span></span>
<span><span class="co">#&gt; 1_1 image1 4215.889 158847.7      Dendritic</span></span>
<span><span class="co">#&gt; 2_1 image1 6092.889 158834.7     Macrophage</span></span>
<span><span class="co">#&gt; 3_1 image1 7214.889 158843.7 Neuroendocrine</span></span>
<span><span class="co">#&gt; 4_1 image1 7418.889 158813.7     Macrophage</span></span>
<span><span class="co">#&gt; 5_1 image1 7446.889 158845.7     Macrophage</span></span>
<span><span class="co">#&gt; 6_1 image1 3254.889 158838.7          CD4 T</span></span></code></pre></div>
<p>Run Gibbs Sampling</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Gibbs sampling</span></span>
<span><span class="va">gibbs.res</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/SpaTopic_inference.html">SpaTopic_inference</a></span><span class="op">(</span><span class="va">lung5</span>, ntopics <span class="op">=</span> <span class="fl">7</span>, sigma <span class="op">=</span> <span class="fl">50</span>, region_radius <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "number of cells per image:"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; image1 </span></span>
<span><span class="co">#&gt; 100149 </span></span>
<span><span class="co">#&gt; [1] "Initialization...."</span></span>
<span><span class="co">#&gt; [1] "Numer of Initializations:"</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; [1] "Min perplexity during initialization:"</span></span>
<span><span class="co">#&gt; [1] 11.63023</span></span>
<span><span class="co">#&gt; [1] "number of region centers selected:"</span></span>
<span><span class="co">#&gt; [1] 971</span></span>
<span><span class="co">#&gt; [1] "number of cells per region on average:"</span></span>
<span><span class="co">#&gt; [1] 103.1401</span></span>
<span><span class="co">#&gt; [1] "Finish initialization. Start Gibbs sampling...."</span></span>
<span><span class="co">#&gt; [1] "Output model perplexity.."</span></span>
<span><span class="co">#&gt; [1] 11.31563</span></span></code></pre></div>
<p>Check the output of SpaTopic</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">gibbs.res</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 8</span></span>
<span><span class="co">#&gt;  $ Perplexity   : num 11.3</span></span>
<span><span class="co">#&gt;  $ Deviance     : num 485960</span></span>
<span><span class="co">#&gt;  $ loglikelihood: num -242980</span></span>
<span><span class="co">#&gt;  $ Beta         : num [1:38, 1:7] 0.03587 0.02539 0.00755 0.01858 0.02585 ...</span></span>
<span><span class="co">#&gt;  $ Theta        : num [1:971, 1:7] 0.855601 0.000232 0.999269 0.99889 0.998725 ...</span></span>
<span><span class="co">#&gt;  $ Ndk          : int [1:971, 1:7] 107 0 82 54 47 72 100 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ Nwk          : int [1:38, 1:7] 390 276 82 202 281 505 697 522 29 58 ...</span></span>
<span><span class="co">#&gt;  $ Z.trace      : int [1:100149, 1:7] 13 173 27 164 157 4 20 21 15 19 ...</span></span></code></pre></div>
<p>For more detailed usage of SpaTopic and how to interprete output from SpaTopic, please check the complete tutorial in <a href="https://xiyupeng.github.io/SpaTopic/" class="external-link">SpaTopic Home Page</a>. We also provide a function to prepare input from Seurat v5 object.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Xiyu Peng.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
